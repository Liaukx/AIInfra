1
00:00:00,100 --> 00:00:03,266
内容/录制:Z0MI 酱，视频剪辑/字幕:岛酱

2
00:00:03,266 --> 00:00:03,900
hello 大家好

3
00:00:03,900 --> 00:00:04,533
我是 ZOMI

4
00:00:04,533 --> 00:00:04,900
今天

5
00:00:04,900 --> 00:00:07,400
回到了上一期视频没讲完的内容

6
00:00:07,400 --> 00:00:10,266
看一下 AI 集群的网络的基本知识

7
00:00:10,266 --> 00:00:11,866
在深入到 AI 集群

8
00:00:11,866 --> 00:00:13,833
一个万卡集群里面的网络的时候

9
00:00:13,833 --> 00:00:17,133
需要前置了解的相关的内容

10
00:00:17,400 --> 00:00:19,100
哈哈哈开始吧

11
00:00:19,233 --> 00:00:20,333
在这期视频里面

12
00:00:20,333 --> 00:00:22,733
主要是分享上一节没讲完的东西

13
00:00:22,733 --> 00:00:25,000
第一个呢就是网络的硬件的基础

14
00:00:25,000 --> 00:00:26,933
第二个呢就是通信的机制

15
00:00:26,933 --> 00:00:29,400
说白了就是交通的基础设施

16
00:00:29,400 --> 00:00:31,400
里面那条路是怎么修

17
00:00:31,400 --> 00:00:32,233
修完之后

18
00:00:32,233 --> 00:00:35,266
交通法规到底是怎么样

19
00:00:35,333 --> 00:00:37,133
今天详细打开这两个内容

20
00:00:37,133 --> 00:00:39,233
如果大家忘记了前两个内容讲了什么

21
00:00:39,233 --> 00:00:41,100
也可以翻回上一个视频看一下

22
00:00:41,100 --> 00:00:43,466
上一期或者上一节视频里面讲

23
00:00:43,466 --> 00:00:44,800
网络的基础的架构

24
00:00:44,800 --> 00:00:47,266
还有决定网络效率的带宽

25
00:00:47,266 --> 00:00:48,500
和流量的控制

26
00:00:48,500 --> 00:00:50,033
相关的知识点

27
00:00:51,433 --> 00:00:54,400
这是网络的一个硬件的基础

28
00:00:54,400 --> 00:00:56,666
那对应的就是整体的交通

29
00:00:56,666 --> 00:00:58,133
整体的基础设施

30
00:00:58,133 --> 00:00:59,233
其实呢大家会发现

31
00:00:59,233 --> 00:01:00,600
整个 AI 集群的网络

32
00:01:00,600 --> 00:01:02,833
会分开非常多个平面

33
00:01:02,833 --> 00:01:03,666
那这个时候

34
00:01:03,666 --> 00:01:04,266
多个平面

35
00:01:04,266 --> 00:01:06,333
主要是对一些网络的业务

36
00:01:06,333 --> 00:01:07,266
进行隔离

37
00:01:07,266 --> 00:01:09,300
也就是所谓的专用的数据

38
00:01:09,300 --> 00:01:10,833
使用专用的网络

39
00:01:10,833 --> 00:01:12,466
那在整个 AI 集群里面

40
00:01:12,466 --> 00:01:13,233
可能

41
00:01:13,233 --> 00:01:16,300
大致分为三个平面的三个网络面

42
00:01:16,366 --> 00:01:19,233
网络面跟网络面之间呢是相互隔离

43
00:01:19,233 --> 00:01:19,933
也就是

44
00:01:19,933 --> 00:01:21,133
a 网络的数据

45
00:01:21,133 --> 00:01:23,333
不会传到 b 网络里面去传

46
00:01:23,333 --> 00:01:24,333
b 网络的数据

47
00:01:24,333 --> 00:01:27,300
跟 c 网络跟 a 网络呢也是完全隔绝

48
00:01:27,300 --> 00:01:28,400
也就是专用的网络

49
00:01:28,400 --> 00:01:29,033
专用的数

50
00:01:29,033 --> 00:01:30,000
据那这里面

51
00:01:30,000 --> 00:01:31,633
ZOMI 简单的过一下

52
00:01:31,633 --> 00:01:34,133
后面呢会用这个图来进行展开

53
00:01:34,133 --> 00:01:36,400
首先呢就是数据面

54
00:01:36,400 --> 00:01:39,000
数据面呢就是传输专用的训练的数据

55
00:01:39,000 --> 00:01:39,800
参数面

56
00:01:39,800 --> 00:01:42,066
就是处理网络模型的参数

57
00:01:42,066 --> 00:01:43,100
当然还有控制面

58
00:01:43,100 --> 00:01:44,666
或者带内带外的管理面

59
00:01:44,666 --> 00:01:45,533
那这个时候

60
00:01:45,533 --> 00:01:46,433
主要是和一些

61
00:01:46,433 --> 00:01:48,833
管理和控制相关的内容

62
00:01:48,933 --> 00:01:49,600
会发现

63
00:01:49,600 --> 00:01:52,500
在做 AI 集群的网络优化的时候

64
00:01:52,500 --> 00:01:54,866
专门的是针对多平面的优化

65
00:01:54,866 --> 00:01:56,233
就是单独平面的优化

66
00:01:56,233 --> 00:01:58,500
显著提升整体的训练的效率

67
00:01:58,500 --> 00:02:00,133
下面呢看一下这个图

68
00:02:00,133 --> 00:02:01,900
所谓的参数面

69
00:02:01,900 --> 00:02:03,466
主要是指训练的服务器

70
00:02:03,466 --> 00:02:04,533
那左边的这一坨

71
00:02:04,533 --> 00:02:07,000
就是具体的计算的服务器

72
00:02:07,000 --> 00:02:10,000
或者 g p u 对应的集群

73
00:02:10,000 --> 00:02:12,133
那这些集群跟集群之间的数据

74
00:02:12,133 --> 00:02:13,333
参数进行交互

75
00:02:13,333 --> 00:02:14,700
就是权重的参数

76
00:02:14,700 --> 00:02:15,666
梯度的参数

77
00:02:15,666 --> 00:02:16,300
这些交互

78
00:02:16,300 --> 00:02:19,500
完全是通过 AI 的参数面

79
00:02:19,500 --> 00:02:21,800
左边的这一坨去完成整体的交互

80
00:02:21,800 --> 00:02:23,233
不会传到其他地方

81
00:02:23,233 --> 00:02:24,800
那另外的话还有数据面

82
00:02:24,800 --> 00:02:25,600
所谓的数据面

83
00:02:25,600 --> 00:02:26,800
就是数据

84
00:02:26,800 --> 00:02:27,933
存储的数据

85
00:02:27,933 --> 00:02:29,100
训练的数据

86
00:02:29,100 --> 00:02:30,666
需要给服务器

87
00:02:30,666 --> 00:02:33,933
就多个 batch 塞进来进行一个训练

88
00:02:33,933 --> 00:02:34,666
那这个时候

89
00:02:34,666 --> 00:02:35,433
这些数据

90
00:02:35,433 --> 00:02:38,333
就会走单独的一个数据面的网络

91
00:02:38,333 --> 00:02:39,900
当然还有一些业务面

92
00:02:39,900 --> 00:02:41,300
业务面就是对业务

93
00:02:41,300 --> 00:02:42,033
进行控制

94
00:02:42,033 --> 00:02:43,233
还有一些运维面

95
00:02:43,233 --> 00:02:44,666
管理面的网络

96
00:02:44,666 --> 00:02:46,300
那基本上呢会分开

97
00:02:46,300 --> 00:02:49,066
最重要的是参数面的网络单独的优化

98
00:02:49,066 --> 00:02:51,200
数据面的网络单独的优化

99
00:02:51,200 --> 00:02:51,800
那这个时候

100
00:02:51,800 --> 00:02:54,400
就是网络的多平面的划分

101
00:02:54,400 --> 00:02:55,500
将会在后面

102
00:02:55,500 --> 00:02:56,700
详细的打开

103
00:02:56,700 --> 00:03:00,033
各种平面的一个具体的内容

104
00:03:00,533 --> 00:03:02,333
那这个时候现在要了解一下

105
00:03:02,333 --> 00:03:04,800
所谓的那个交换机的铁疙瘩

106
00:03:04,800 --> 00:03:07,100
经常说到的框式盒式

107
00:03:07,100 --> 00:03:08,200
还有框盒式

108
00:03:08,200 --> 00:03:11,000
盒盒式框框式到底有什么区别

109
00:03:11,000 --> 00:03:13,333
那这个时候你会发现整个万卡集群

110
00:03:13,333 --> 00:03:15,666
因为需要非常多的交换机

111
00:03:15,666 --> 00:03:17,433
而且交换机的端口数

112
00:03:17,433 --> 00:03:18,933
远超于普通的 DC

113
00:03:18,933 --> 00:03:21,000
也就是传统的 IDC 的数据中心

114
00:03:21,000 --> 00:03:21,433
所以说

115
00:03:21,433 --> 00:03:24,433
传统的网络架构是没有办法去覆盖

116
00:03:24,433 --> 00:03:26,800
因此呢引入了盒框式框

117
00:03:26,800 --> 00:03:28,033
盒和盒式

118
00:03:28,200 --> 00:03:30,533
各种各样的交换机的设备进来

119
00:03:30,533 --> 00:03:31,133
那这里面

120
00:03:31,133 --> 00:03:32,466
因为在整个 AI 机群

121
00:03:32,466 --> 00:03:34,733
要使用大量的交换机

122
00:03:34,733 --> 00:03:36,800
因此呢需要去区分

123
00:03:36,800 --> 00:03:38,033
框式交换机

124
00:03:38,033 --> 00:03:39,700
跟盒式交换机的内容

125
00:03:39,700 --> 00:03:41,633
那简单看一下具体的区别

126
00:03:41,633 --> 00:03:43,900
左边的这个呢就对应的框式的交换机

127
00:03:43,900 --> 00:03:45,833
右边呢就是盒式的交换机

128
00:03:45,833 --> 00:03:49,033
首先呢先看一下它的一个形态

129
00:03:49,033 --> 00:03:50,500
然后再去了解一下

130
00:03:50,500 --> 00:03:52,266
框式跟盒式

131
00:03:52,266 --> 00:03:54,233
到底有哪些本质上的区别

132
00:03:54,300 --> 00:03:56,733
左边的这块呢就是框式的交换机

133
00:03:56,733 --> 00:03:57,466
大家看到没有

134
00:03:57,466 --> 00:03:58,733
非常的大

135
00:03:58,733 --> 00:03:59,800
占了好多呦

136
00:03:59,800 --> 00:04:00,900
那右边的这个

137
00:04:00,900 --> 00:04:03,100
就是盒式的交换机

138
00:04:03,100 --> 00:04:06,033
盒式交换机呢像非常像薄一点

139
00:04:06,033 --> 00:04:09,433
有可能呢嵌嵌在整个机柜的柜

140
00:04:09,666 --> 00:04:10,833
然后宽式交换机

141
00:04:10,833 --> 00:04:13,900
有可能是单独的一排机柜呢去存放

142
00:04:13,900 --> 00:04:14,833
那右边的这个

143
00:04:14,833 --> 00:04:18,333
就是有 64 口 800G 的一个合式交换机

144
00:04:18,333 --> 00:04:18,933
那下面

145
00:04:18,933 --> 00:04:21,300
为什么会更加宽一点

146
00:04:21,300 --> 00:04:23,500
是因为它提供了 128 个

147
00:04:23,500 --> 00:04:26,466
400G 的一个对应的网络的端口

148
00:04:27,033 --> 00:04:27,466
那现在

149
00:04:27,466 --> 00:04:29,866
看一下框式跟盒式具体的区别

150
00:04:29,866 --> 00:04:31,233
那首先呢物理形态呀

151
00:04:31,233 --> 00:04:33,033
刚才看到了框式交换机

152
00:04:33,033 --> 00:04:33,733
非常的长

153
00:04:33,733 --> 00:04:34,466
非常的高

154
00:04:34,466 --> 00:04:36,600
它是一个机架式的铁框

155
00:04:36,700 --> 00:04:37,800
那右边的这个

156
00:04:37,800 --> 00:04:38,633
盒式交换机

157
00:04:38,633 --> 00:04:40,833
它是一个独立的铁盒子

158
00:04:40,833 --> 00:04:42,266
所以说非常方便

159
00:04:42,266 --> 00:04:44,866
插进去整个机柜的柜顶

160
00:04:44,866 --> 00:04:46,600
或者机柜的柜中间

161
00:04:46,800 --> 00:04:48,866
了解完对应的物理形态之后

162
00:04:48,866 --> 00:04:51,133
看一下现在的典型的成本

163
00:04:51,133 --> 00:04:51,866
那基本上

164
00:04:51,866 --> 00:04:54,533
整个框式的交换机造价是非常高

165
00:04:54,533 --> 00:04:55,866
而盒式的交换机

166
00:04:55,866 --> 00:04:57,933
单台呢是没有那么的贵

167
00:04:57,933 --> 00:04:59,233
3-8 万左右

168
00:04:59,233 --> 00:05:01,133
那适用的场景也比较有区别

169
00:05:01,133 --> 00:05:02,400
整个框式的交换机

170
00:05:02,400 --> 00:05:04,333
主要是接入核心层

171
00:05:04,333 --> 00:05:06,233
也是对应的 spine 层

172
00:05:06,233 --> 00:05:08,433
后面会讲到路由的拓扑

173
00:05:08,433 --> 00:05:09,733
到底是怎么接入

174
00:05:09,933 --> 00:05:11,333
这些交换器接入 TOR

175
00:05:11,333 --> 00:05:13,233
一般呢都是做接入层

176
00:05:13,233 --> 00:05:14,866
也就柜顶直接连接

177
00:05:14,866 --> 00:05:16,100
GPU

178
00:05:16,100 --> 00:05:17,466
直接放在柜顶

179
00:05:17,466 --> 00:05:19,866
那整体的特点也比较明确

180
00:05:19,866 --> 00:05:20,900
宽窄交换器比较大

181
00:05:20,900 --> 00:05:22,633
它可以做到模块化的设计

182
00:05:22,633 --> 00:05:24,000
可热插拔

183
00:05:24,000 --> 00:05:24,933
盒式交换机

184
00:05:24,933 --> 00:05:27,000
只要呢是采用一个一体化的设计

185
00:05:27,000 --> 00:05:28,033
做到成本比较低

186
00:05:28,033 --> 00:05:29,100
部署比较简单

187
00:05:29,100 --> 00:05:32,300
反正呢整个盒子的这么去替换就好

188
00:05:32,300 --> 00:05:33,000
那框式

189
00:05:33,000 --> 00:05:34,000
因为装的比较大

190
00:05:34,000 --> 00:05:35,733
所以说是模块化的方式

191
00:05:35,733 --> 00:05:37,800
不是整体的去替换

192
00:05:37,900 --> 00:05:39,300
那现在来看一下

193
00:05:39,466 --> 00:05:40,900
其实框式交换机

194
00:05:40,900 --> 00:05:42,700
是非常非常的重要

195
00:05:42,700 --> 00:05:44,500
那为什么框式交换机重要

196
00:05:44,633 --> 00:05:47,566
整个集群的网络规模非常的大

197
00:05:47,566 --> 00:05:49,800
而且呢框式主要是接入核心层

198
00:05:49,800 --> 00:05:52,466
需要 7*24 小时不停

199
00:05:52,466 --> 00:05:54,633
去运转不停的交换数据

200
00:05:54,633 --> 00:05:56,433
所以说整体的框式交换机

201
00:05:56,433 --> 00:05:57,633
变得非常的重要

202
00:05:57,633 --> 00:05:59,700
而且呢需要支持在线

203
00:05:59,700 --> 00:06:02,100
更换对应的故障的模块

204
00:06:02,100 --> 00:06:03,833
做到了不停机这种方式

205
00:06:03,833 --> 00:06:05,333
所以说你会发现下面

206
00:06:05,333 --> 00:06:07,633
支持非常多的电源的插槽

207
00:06:07,633 --> 00:06:09,300
和电源的模块

208
00:06:09,800 --> 00:06:11,433
既然谈到硬件

209
00:06:11,433 --> 00:06:14,400
它里面后面的传输的一个介质

210
00:06:14,400 --> 00:06:16,066
到底用什么也很重要

211
00:06:16,066 --> 00:06:16,866
因为英伟达

212
00:06:16,866 --> 00:06:18,233
在 b 系列里面

213
00:06:18,233 --> 00:06:20,433
也推出了自己的一个具体的方案

214
00:06:20,433 --> 00:06:22,033
走的是铜缆

215
00:06:22,033 --> 00:06:23,666
这个时候呢不再是光纤

216
00:06:23,666 --> 00:06:24,733
所以大家可以看到

217
00:06:24,733 --> 00:06:27,600
从这里面的 NV switch 的 rack 里面

218
00:06:27,600 --> 00:06:28,933
走出来的是一个铜缆

219
00:06:28,933 --> 00:06:31,100
然后对接到其他的芯片里面

220
00:06:31,100 --> 00:06:32,533
或者对接到其他的 GPU

221
00:06:32,700 --> 00:06:34,933
和其他的 switch 的版里面

222
00:06:34,933 --> 00:06:35,900
那当然

223
00:06:35,900 --> 00:06:37,733
也有很多的方案

224
00:06:37,733 --> 00:06:39,133
走的是光纤

225
00:06:39,133 --> 00:06:41,600
这里面呢出光非常多的光纤的口

226
00:06:41,600 --> 00:06:42,666
去做一个互联

227
00:06:42,666 --> 00:06:44,900
所以说这里面呢就对比一下

228
00:06:44,900 --> 00:06:47,333
铜缆跟光纤到底有哪些区别

229
00:06:47,333 --> 00:06:49,000
什么时候上铜缆

230
00:06:49,000 --> 00:06:51,233
什么时候上光纤

231
00:06:51,300 --> 00:06:53,700
现在呢比较明确的就是铜缆

232
00:06:53,700 --> 00:06:56,400
它整体的成本是比较低

233
00:06:56,400 --> 00:06:57,800
但是呢有个最大的问题

234
00:06:57,800 --> 00:06:59,233
就是它的一个传输距离

235
00:06:59,233 --> 00:07:00,466
其实是非常有限

236
00:07:00,466 --> 00:07:01,300
小于 5 米

237
00:07:01,300 --> 00:07:02,533
因为大于 7 米之后

238
00:07:02,533 --> 00:07:04,466
整体的一个信号的衰减

239
00:07:04,466 --> 00:07:05,700
是非常的高

240
00:07:05,700 --> 00:07:06,800
而光纤

241
00:07:06,800 --> 00:07:08,666
整体的信号的衰减可以比较低

242
00:07:08,666 --> 00:07:11,000
而且光纤呢还可以进行中继

243
00:07:11,200 --> 00:07:11,733
这里面

244
00:07:11,733 --> 00:07:13,300
光纤的传输距离

245
00:07:13,300 --> 00:07:14,866
就变得非常的高

246
00:07:14,866 --> 00:07:16,266
而且传输速率

247
00:07:16,266 --> 00:07:18,333
光纤是非常的大

248
00:07:18,333 --> 00:07:19,900
整体铜缆的传输速率

249
00:07:19,900 --> 00:07:21,900
现在还没有做到这么大

250
00:07:21,900 --> 00:07:22,700
因此你会发

251
00:07:22,700 --> 00:07:24,700
现呢这里面的最大的区别就是

252
00:07:24,700 --> 00:07:26,066
传输的原理

253
00:07:26,066 --> 00:07:27,633
或者传输的内容不一样

254
00:07:27,633 --> 00:07:28,266
那铜缆

255
00:07:28,266 --> 00:07:30,500
主要是靠电信号进行传输

256
00:07:30,500 --> 00:07:32,033
光纤呢主要是靠激光

257
00:07:32,033 --> 00:07:34,833
脉冲光信号进行传输

258
00:07:34,833 --> 00:07:36,200
所以说一般来说

259
00:07:36,200 --> 00:07:37,400
如果像英伟达那样

260
00:07:37,400 --> 00:07:39,500
他可能现在在 NVL72

261
00:07:39,500 --> 00:07:40,066
那这种

262
00:07:40,066 --> 00:07:41,233
单机柜

263
00:07:41,233 --> 00:07:43,066
或者做成一个

264
00:07:43,066 --> 00:07:44,500
反正呢就是一个机柜

265
00:07:44,500 --> 00:07:46,066
那可能可以用铜

266
00:07:46,166 --> 00:07:47,900
但是呢如果多排机柜之间

267
00:07:47,900 --> 00:07:49,666
就没有办法完全用铜

268
00:07:49,666 --> 00:07:51,433
那可能还是得上光纤

269
00:07:51,433 --> 00:07:52,433
所以说这里面

270
00:07:52,433 --> 00:07:54,033
整个铜缆的方式

271
00:07:54,033 --> 00:07:56,000
更适合服务器内部

272
00:07:56,000 --> 00:07:58,000
还有短距离的一个连接

273
00:07:58,000 --> 00:07:59,200
如果要做超节点

274
00:07:59,200 --> 00:08:00,833
做 384 做 576

275
00:08:00,833 --> 00:08:01,533
如果用铜缆

276
00:08:01,533 --> 00:08:02,866
会变得非常的吃力

277
00:08:02,866 --> 00:08:04,600
要解决信号的衰减的问题

278
00:08:04,600 --> 00:08:06,066
还有传输速率的问题

279
00:08:06,166 --> 00:08:09,000
那真正的做大规模的 scale up 的时候

280
00:08:09,000 --> 00:08:10,866
可能更多的是用光纤

281
00:08:10,866 --> 00:08:12,466
能够在数据中心之间

282
00:08:12,466 --> 00:08:14,833
还有机柜之间进行一个传输

283
00:08:14,833 --> 00:08:15,666
这也就是铜缆

284
00:08:15,666 --> 00:08:17,400
跟光纤的一个最大的区别

285
00:08:17,400 --> 00:08:19,533
当然现在有很多不同的方案

286
00:08:19,533 --> 00:08:21,866
之前也炒热过一波铜

287
00:08:21,866 --> 00:08:23,933
呃反正 ZOMI 是没看明白

288
00:08:23,933 --> 00:08:25,700
铜也能炒热

289
00:08:25,700 --> 00:08:26,500
明白了吗

290
00:08:26,533 --> 00:08:28,066
那这里面用到的同

291
00:08:28,066 --> 00:08:30,800
其实并没有那么的多

292
00:08:31,433 --> 00:08:33,600
现在再来看一下下一个内容

293
00:08:33,600 --> 00:08:36,433
就是整个通信的机制

294
00:08:36,433 --> 00:08:38,033
那所谓的通信之机制

295
00:08:38,033 --> 00:08:40,133
主要是指数据传输的方式

296
00:08:40,133 --> 00:08:42,700
到底用什么方式来去传数据

297
00:08:42,866 --> 00:08:43,633
那这个时候

298
00:08:43,633 --> 00:08:46,866
你就会发觉整体的一个硬件

299
00:08:46,866 --> 00:08:48,300
其实也跟硬件比较相关

300
00:08:48,300 --> 00:08:50,900
就是单轨跟多轨的通信

301
00:08:50,900 --> 00:08:52,333
那什么是单轨跟多轨

302
00:08:52,333 --> 00:08:54,666
通信呢看一下下面的这个图案

303
00:08:54,666 --> 00:08:57,733
你会发现左边的是单独的一个节点

304
00:08:57,733 --> 00:09:00,600
那这个呢就是 GPU 节点 a

305
00:09:00,600 --> 00:09:03,666
右边呢那这个就是 GPU 节点 2

306
00:09:03,666 --> 00:09:04,933
那节点 a 之间

307
00:09:04,933 --> 00:09:05,833
有 8 张卡

308
00:09:05,833 --> 00:09:08,600
01234567 啊八张卡

309
00:09:08,600 --> 00:09:09,900
那八张卡之前

310
00:09:09,900 --> 00:09:11,400
地灵卡

311
00:09:11,400 --> 00:09:13,266
想跟 GPU 二卡

312
00:09:13,266 --> 00:09:14,700
进行一个交互的时候

313
00:09:14,700 --> 00:09:16,233
你会发现里面

314
00:09:16,233 --> 00:09:18,500
呃首先呢不是走上面的这种交换机

315
00:09:18,500 --> 00:09:21,000
而是走里面的 NV switch

316
00:09:21,066 --> 00:09:21,533
那这种

317
00:09:21,533 --> 00:09:23,800
其实是不是单轨跟多轨的通信

318
00:09:23,800 --> 00:09:25,533
而是上一节视频讲到

319
00:09:25,533 --> 00:09:27,633
单层网络跟多层网络的问题

320
00:09:27,633 --> 00:09:28,233
那这里面

321
00:09:28,233 --> 00:09:32,133
是多层网络里面的单轨跟多轨通信

322
00:09:32,200 --> 00:09:35,633
假设现在的 GPU A 的 0 卡

323
00:09:35,633 --> 00:09:38,300
跟 GPU B 的 1 卡

324
00:09:38,300 --> 00:09:40,066
进行一个通信的时候

325
00:09:40,066 --> 00:09:43,100
需要从后面的 NIC 对应的网口

326
00:09:43,100 --> 00:09:44,900
走到 L1 的交换机

327
00:09:44,900 --> 00:09:47,200
然后 L1 的交换机再走回来

328
00:09:47,200 --> 00:09:49,533
给到 GPU 节点 2 的第 0 网卡

329
00:09:49,533 --> 00:09:51,300
进行数据的传输

330
00:09:51,300 --> 00:09:54,433
这个时候消耗了一个交换机

331
00:09:54,433 --> 00:09:55,066
那这种

332
00:09:55,066 --> 00:09:56,900
还不叫单轨跟多轨

333
00:09:56,933 --> 00:09:57,600
那另外的话

334
00:09:57,600 --> 00:09:59,600
如果我的 GPU1

335
00:09:59,600 --> 00:10:01,500
通过另外一个卡走过来

336
00:10:01,500 --> 00:10:03,700
那这个时候我涉及到两个

337
00:10:03,700 --> 00:10:06,600
就是第二个交换机

338
00:10:06,666 --> 00:10:08,233
然后呢传到另外一个

339
00:10:08,233 --> 00:10:10,833
这个时候就涉及到多轨

340
00:10:10,866 --> 00:10:11,500
那这个时候

341
00:10:11,500 --> 00:10:13,466
大家就比较清楚多轨的意思

342
00:10:13,466 --> 00:10:15,633
我需要花多个交换机

343
00:10:15,733 --> 00:10:17,233
那所谓的单轨

344
00:10:17,233 --> 00:10:18,500
也比较好理解

345
00:10:18,500 --> 00:10:21,333
同样的现在是 GPU 的节点一

346
00:10:21,333 --> 00:10:23,833
那这个呢就是 GPU 的节点 2

347
00:10:24,133 --> 00:10:26,400
假设呢现在的 GPU0

348
00:10:26,400 --> 00:10:28,933
想跟另外一个卡的 GPU0 进行通信

349
00:10:28,933 --> 00:10:29,900
走的是其

350
00:10:29,900 --> 00:10:31,933
中的第一个交换机

351
00:10:32,000 --> 00:10:33,466
定的 GPU1 的第三张卡

352
00:10:33,466 --> 00:10:35,833
想跟 GPU2 的第三张卡进行通信

353
00:10:35,833 --> 00:10:38,000
我走的还是同一个交换机

354
00:10:38,000 --> 00:10:40,833
那这种方式呢叫做单轨的通信

355
00:10:40,833 --> 00:10:42,233
那同一个节点内

356
00:10:42,233 --> 00:10:43,333
跨交换机的通信

357
00:10:43,333 --> 00:10:45,133
这种呢叫做多轨

358
00:10:45,166 --> 00:10:46,233
了解完对应的图片之后

359
00:10:46,233 --> 00:10:47,733
现在来看一下单轨通信

360
00:10:47,733 --> 00:10:50,000
跟多轨通信的一个文字的描述

361
00:10:50,000 --> 00:10:50,866
单轨通信

362
00:10:50,866 --> 00:10:52,933
就像单车道的一个公路

363
00:10:52,933 --> 00:10:54,900
数据呢是排队的传输

364
00:10:54,900 --> 00:10:55,266
所以说

365
00:10:55,266 --> 00:10:58,300
很多张卡都是等一个交换机

366
00:10:58,300 --> 00:10:59,633
那像多轨的通信

367
00:10:59,633 --> 00:11:01,800
其实比较像多车道的高速的公路

368
00:11:01,800 --> 00:11:03,800
数据呢是并行的传输

369
00:11:03,800 --> 00:11:05,300
有不同的交换机

370
00:11:05,300 --> 00:11:07,800
传输不同轨道的数据

371
00:11:07,866 --> 00:11:09,133
那像单轨的通信

372
00:11:09,133 --> 00:11:10,200
其实呃

373
00:11:10,200 --> 00:11:12,500
比较常见的就是传统的以太网的中心

374
00:11:12,500 --> 00:11:14,933
因为对数据的传输的效率

375
00:11:14,933 --> 00:11:16,400
没有那么的讲究

376
00:11:16,400 --> 00:11:17,533
那多轨的通信

377
00:11:17,533 --> 00:11:19,333
其实像现在的 GPU

378
00:11:19,333 --> 00:11:21,600
就基本上采用多轨的通信

379
00:11:21,600 --> 00:11:22,666
那单轨的通信

380
00:11:22,666 --> 00:11:23,500
像刚才讲到

381
00:11:23,500 --> 00:11:24,866
比较容易产生拥塞

382
00:11:24,866 --> 00:11:27,733
不太适合 AI 大规模的训练

383
00:11:27,900 --> 00:11:28,733
多轨的通信

384
00:11:28,733 --> 00:11:30,633
是 scale up 的一个具体的关键

385
00:11:30,633 --> 00:11:33,066
所以说现在的一个做 scale up

386
00:11:33,066 --> 00:11:34,300
只做 scale out 也好

387
00:11:34,300 --> 00:11:36,900
现在慢慢的做多轨的通信

388
00:11:36,900 --> 00:11:38,666
当然呢有一些厂商也会指定哎

389
00:11:38,666 --> 00:11:39,900
我必须要用单轨

390
00:11:39,900 --> 00:11:40,533
有一些厂商

391
00:11:40,533 --> 00:11:42,433
指定我可能必须要用多轨

392
00:11:42,466 --> 00:11:44,033
说没有完全的定义

393
00:11:44,033 --> 00:11:46,800
这里不适合 AI 通信的也不完全是

394
00:11:46,800 --> 00:11:49,200
具体呢是看 AI 的任务

395
00:11:49,833 --> 00:11:51,933
在讲完整个网络的基础知识

396
00:11:51,933 --> 00:11:54,633
之后呢来个总结跟思考

397
00:11:54,833 --> 00:11:56,400
大家回顾一下在整

398
00:11:56,400 --> 00:11:57,533
个网络基础里面

399
00:11:57,533 --> 00:11:58,933
其实只是交代一些

400
00:11:58,933 --> 00:12:00,533
基本的网络的术语

401
00:12:00,533 --> 00:12:02,700
很多的术语呢将会在后面

402
00:12:02,700 --> 00:12:05,333
后面的视频详细的去进行展开

403
00:12:05,500 --> 00:12:07,700
首先来了解了网络的架构

404
00:12:07,700 --> 00:12:09,533
就是单层跟双层的网络

405
00:12:09,533 --> 00:12:11,133
或者单层跟多层的网络

406
00:12:11,133 --> 00:12:14,100
接着看一下网络效率相关的内容

407
00:12:14,266 --> 00:12:17,233
主要是指网络的收敛性和网络的拓扑

408
00:12:17,233 --> 00:12:18,066
那第三个内容

409
00:12:18,066 --> 00:12:19,433
就是今天刚刚分享

410
00:12:19,433 --> 00:12:21,533
就是网络的硬件的基础

411
00:12:21,533 --> 00:12:22,600
对应的盒式跟框式

412
00:12:22,600 --> 00:12:23,333
对应的铜缆

413
00:12:23,333 --> 00:12:25,933
跟光纤相关的硬件的内容

414
00:12:25,933 --> 00:12:27,300
还有通信的机制

415
00:12:27,300 --> 00:12:29,233
到底是走单轨的还是多轨

416
00:12:29,233 --> 00:12:29,800
这个时候

417
00:12:29,800 --> 00:12:32,066
就决定数据的通信的方式

418
00:12:32,166 --> 00:12:32,466
然后

419
00:12:32,466 --> 00:12:35,266
现在呢来做一个简单的总结

420
00:12:35,266 --> 00:12:36,900
因为了解网络

421
00:12:36,900 --> 00:12:39,466
其实网络是方便整个 AI 集群

422
00:12:39,466 --> 00:12:43,033
做 scale up 跟做 scale out 的一个方式

423
00:12:43,033 --> 00:12:44,800
那 scale out 就是纵向的扩展

424
00:12:44,800 --> 00:12:47,100
反正呢我就往超节点的做

425
00:12:47,100 --> 00:12:49,700
把一个节点呢做大做厚做肥

426
00:12:49,700 --> 00:12:52,433
那 scale out 呢就是把整个超节点

427
00:12:52,433 --> 00:12:54,300
假设我这里面呢有 a 个超节点

428
00:12:54,300 --> 00:12:56,133
所以说会把 a 个超节点

429
00:12:56,133 --> 00:12:57,700
进行互联起来

430
00:12:57,700 --> 00:12:58,933
变成 AAAAA

431
00:12:58,933 --> 00:13:01,000
那这种呢就是横向的扩展

432
00:13:01,000 --> 00:13:03,000
那当然了以前只有一个小 a

433
00:13:03,000 --> 00:13:04,233
现在变成一个大 a

434
00:13:04,233 --> 00:13:06,400
这种呢就是纵向的扩展

435
00:13:06,400 --> 00:13:06,700
这个

436
00:13:06,700 --> 00:13:09,466
就是 scale up 跟 scale out 最大的区别

437
00:13:09,466 --> 00:13:12,900
现在 scale up 呢主要是指做超节点

438
00:13:12,900 --> 00:13:16,100
那 scale out 呢主要是做万卡集群

439
00:13:16,100 --> 00:13:17,233
那不管哪种方式

440
00:13:17,233 --> 00:13:20,300
都对网络的要求非常的高

441
00:13:20,300 --> 00:13:22,000
通过 scale up 跟 scale out

442
00:13:22,000 --> 00:13:22,333
就可以

443
00:13:22,333 --> 00:13:24,800
把刚才讲到的一些技术点

444
00:13:24,800 --> 00:13:25,400
会串起来

445
00:13:25,400 --> 00:13:28,133
后面呢也会重点的详细的展开

446
00:13:28,133 --> 00:13:29,866
例如我的 scale up 的方式

447
00:13:29,866 --> 00:13:32,800
可能更多的是用全互联 full mesh 的方式

448
00:13:32,800 --> 00:13:33,500
尽可能

449
00:13:33,500 --> 00:13:34,500
不惜代价

450
00:13:34,500 --> 00:13:37,633
做到所有的卡之间的一个直连

451
00:13:37,633 --> 00:13:38,433
那这个时候

452
00:13:38,433 --> 00:13:40,733
整个超级点之间的带宽

453
00:13:40,733 --> 00:13:42,466
就可以做的非常的高

454
00:13:42,466 --> 00:13:43,833
而整个万卡机区

455
00:13:43,833 --> 00:13:45,533
更多的是做一个胖树

456
00:13:45,533 --> 00:13:47,233
或者做一个高级的拓扑

457
00:13:47,233 --> 00:13:48,866
去平衡效率

458
00:13:48,866 --> 00:13:50,933
一个经济的问题

459
00:13:50,933 --> 00:13:52,333
当然呢数据的传输

460
00:13:52,333 --> 00:13:53,933
因为做了一个 full mash 的传输

461
00:13:53,933 --> 00:13:56,066
说机箱内呢可以走光纤

462
00:13:56,066 --> 00:13:57,133
也可以走铜缆

463
00:13:57,133 --> 00:13:59,266
当然呢走光纤的成本会大很多

464
00:13:59,266 --> 00:14:00,500
但是呢跨机柜

465
00:14:00,500 --> 00:14:02,833
因为长距离的数据的传输

466
00:14:02,833 --> 00:14:05,533
所以说必须使用对应的光纤

467
00:14:05,700 --> 00:14:07,200
不管是 scale up 跟 scale out

468
00:14:07,200 --> 00:14:09,100
整个网络的平面

469
00:14:09,100 --> 00:14:10,700
都会进行一个划分

470
00:14:10,700 --> 00:14:11,833
那今天的内容

471
00:14:11,833 --> 00:14:12,733
就讲到这里为止

472
00:14:12,733 --> 00:14:13,400
谢谢各位

473
00:14:13,400 --> 00:14:14,466
拜了个拜
